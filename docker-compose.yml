version: "3.9"

services:
  redis:
    image: redis:7-alpine
    ports:
      - "6379:6379"

  app:
    build: .
    environment:
      - REDIS_URL=${REDIS_URL:-redis://redis:6379/0}
      - B24_DOMAIN=${B24_DOMAIN}
      - B24_CLIENT_ID=${B24_CLIENT_ID}
      - B24_CLIENT_SECRET=${B24_CLIENT_SECRET}
      - B24_REDIRECT_URI=${B24_REDIRECT_URI}
      - PUBLIC_DOMAIN=${PUBLIC_DOMAIN}
      - B24_IMBOT_ID=${B24_IMBOT_ID}
      - B24_IMBOT_CODE=${B24_IMBOT_CODE}
      - B24_IMBOT_NAME=${B24_IMBOT_NAME}
      - B24_IMBOT_CLIENT_ID=${B24_IMBOT_CLIENT_ID}
      - HTTP_TIMEOUT_S=${HTTP_TIMEOUT_S:-10}
      - HTTP_RETRIES=${HTTP_RETRIES:-3}
    ports:
      - "8000:8000"
    depends_on:
      - redis
